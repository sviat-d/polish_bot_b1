# –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ ‚Äî Polish B1 Exam Bot

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
polish_bot_b1/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ bot.js                    # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –±–æ—Ç–∞ (entry point)
‚îÇ   ‚îú‚îÄ‚îÄ config.js                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ env –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pdfTasks.js          # ‚≠ê –ó–î–ï–°–¨ –î–û–ë–ê–í–õ–Ø–¢–¨ –ó–ê–î–ê–ù–ò–Ø
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ taskLoader.js        # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–¥–∞–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ commands.js          # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ (/start, /stats, –∏ —Ç.–¥.)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ callbacks.js         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫ (–æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã)
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ userService.js       # –†–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ taskService.js       # –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∑–∞–¥–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ messages.js          # –í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞
‚îÇ       ‚îî‚îÄ‚îÄ keyboard.js          # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–∫–Ω–æ–ø–∫–∏)
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ tasks.json               # ‚ö†Ô∏è –ê–í–¢–û–ì–ï–ù–ï–†–ò–†–£–ï–¢–°–Ø! –ù–ï –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ –í–†–£–ß–ù–£–Æ
‚îÇ   ‚îî‚îÄ‚îÄ users/                   # –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≤ .gitignore)
‚îî‚îÄ‚îÄ package.json
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π

### –ö–æ—Ä–æ—Ç–∫–æ (–¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö):

```bash
# 1. –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
vim src/data/pdfTasks.js  # –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞

# 2. –†–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å
node -e "const loader = require('./src/data/taskLoader'); const tasks = loader.getTasks(); const fs = require('fs'); fs.writeFileSync('./data/tasks.json', JSON.stringify(tasks, null, 2));"

# 3. –ö–æ–º–º–∏—Ç–∏—Ç—å
git add src/data/pdfTasks.js data/tasks.json
git commit -m "feat: add N new tasks"
git push -u origin claude/polish-exam-bot-tT77d
```

### –ü–æ–¥—Ä–æ–±–Ω–æ:

–°–º. [TASK_ADDITION_GUIDE.md](./TASK_ADDITION_GUIDE.md)

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ó–∞–¥–∞–Ω–∏–µ (Task):

```javascript
{
  id: "B1_TOPIC_001",           // –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
  source: "pdf",                // –ò—Å—Ç–æ—á–Ω–∏–∫ (–≤—Å–µ–≥–¥–∞ "pdf")
  question: "Pytanie?",         // –í–æ–ø—Ä–æ—Å
  options: [                    // 3 –∏–ª–∏ 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞
    { label: "A", text: "..." },
    { label: "B", text: "..." },
    { label: "C", text: "..." },
    { label: "D", text: "..." }  // –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
  ],
  correctAnswer: "A",           // A, B, C, –∏–ª–∏ D
  explanationRu: `...`,         // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
  explanationPl: `...`,         // –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª—å—Å–∫–æ–º
  topic: "–¢–µ–º–∞",                // –ö–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–¥–∞–Ω–∏—è
  difficulty: "medium"          // easy, medium, medium-high, high
}
```

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (User):

```javascript
{
  chatId: 123456789,
  completedTasks: [             // –ú–∞—Å—Å–∏–≤ ID –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
    "pdf_B1_REKCJA_001",
    "B1_ASPEKT_004"
  ],
  answers: [                    // –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–≤–µ—Ç–æ–≤
    {
      taskId: "pdf_B1_REKCJA_001",
      topic: "Rekcja czasownik√≥w",
      isCorrect: true,
      userAnswer: "C",
      rating: 5,
      answeredAt: "2026-01-18T10:30:00.000Z"
    }
  ],
  language: "ru",               // –Ø–∑—ã–∫ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π: 'ru' –∏–ª–∏ 'pl'
  currentTaskId: null,
  ratingEnabled: false,
  weakTopicMode: {
    active: false,
    topic: null
  }
}
```

## üîß –í–∞–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### userService.js

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `getOrCreateUser(chatId)` | –ü–æ–ª—É—á–∏—Ç—å/—Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `recordAnswer(chatId, taskId, topic, isCorrect, userAnswer, rating)` | –ó–∞–ø–∏—Å–∞—Ç—å –æ—Ç–≤–µ—Ç |
| `toggleLanguage(chatId)` | –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —è–∑—ã–∫ RU ‚Üî PL |
| `calculateStats(user)` | –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É |

### taskService.js

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `getNextTask(user, filterTopic)` | –ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ –∑–∞–¥–∞–Ω–∏–µ |
| `getTaskById(taskId)` | –ù–∞–π—Ç–∏ –∑–∞–¥–∞–Ω–∏–µ –ø–æ ID |
| `getTotalTasksCount()` | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π |

## üéØ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –§–∞–π–ª |
|---------|----------|------|
| `/start` | –ù–∞—á–∞—Ç—å/–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å | commands.js:56 |
| `/stats` | –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É | commands.js:84 |
| `/weak` | –¢—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å —Å–ª–∞–±—É—é —Ç–µ–º—É | commands.js:102 |
| `/rating` | –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –æ—Ü–µ–Ω–∫—É –∑–∞–¥–∞–Ω–∏–π | commands.js:132 |
| `/reset` | –°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å | commands.js:150 |
| `/lang` | –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —è–∑—ã–∫ –æ–±—ä—è—Å–Ω–µ–Ω–∏–π | commands.js:157 |

## üîç –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

```javascript
// src/utils/messages.js
module.exports = {
  // ...
  newMessage: () => `–¢–≤–æ—ë –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–¥–µ—Å—å`,
};
```

### –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤—ã–±–æ—Ä–∞ –∑–∞–¥–∞–Ω–∏—è

```javascript
// src/services/taskService.js
function getNextTask(user, filterTopic = null) {
  // –¢–≤–æ—è –ª–æ–≥–∏–∫–∞ –∑–¥–µ—Å—å
}
```

### –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É

```javascript
// src/handlers/commands.js
async function handleMyCommand(ctx) {
  await ctx.reply('–û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—É');
}

function registerCommands(bot) {
  // ...
  bot.command('mycommand', handleMyCommand);
}
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# 2. –°–æ–∑–¥–∞—Ç—å .env
echo "TELEGRAM_BOT=your_bot_token_here" > .env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å
npm start
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞–Ω–∏–π

```bash
node -e "console.log(require('./src/data/taskLoader').getTasks().length)"
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ID –∑–∞–¥–∞–Ω–∏–π

```bash
jq -r '.[] | .id' data/tasks.json
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
cat data/users/123456789.json | jq
```

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

| –û—à–∏–±–∫–∞ | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|---------|
| `SyntaxError: Unexpected identifier` | –§–∏–≥—É—Ä–Ω—ã–µ –∫–∞–≤—ã—á–∫–∏ | –ó–∞–º–µ–Ω–∏—Ç—å " –Ω–∞ " |
| –ó–∞–¥–∞–Ω–∏—è –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è | –ó–∞–±—ã–ª–∏ —Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å tasks.json | –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–º–∞–Ω–¥—É —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ |
| –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è | Railway Volume –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω | –°–º. RAILWAY_PERSISTENT_STORAGE.md |

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [TASK_ADDITION_GUIDE.md](./TASK_ADDITION_GUIDE.md) ‚Äî –ü–æ–¥—Ä–æ–±–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π
- [RAILWAY_PERSISTENT_STORAGE.md](./RAILWAY_PERSISTENT_STORAGE.md) ‚Äî –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

## üîê Environment Variables

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ |
|------------|----------|-------------|
| `TELEGRAM_BOT` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | ‚úÖ –î–∞ |

–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ Railway: **Settings** ‚Üí **Variables**

## üì¶ –î–µ–ø–ª–æ–π –Ω–∞ Railway

1. Push –≤ –≤–µ—Ç–∫—É `claude/polish-exam-bot-tT77d`
2. Railway –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–¥–µ–ø–ª–æ–∏—Ç
3. –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏: `Loaded N PDF tasks`

## üé® –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í –æ–±—ä—è—Å–Ω–µ–Ω–∏—è—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–æ:
- –≠–º–æ–¥–∑–∏: üîë ‚ùå ‚ö†Ô∏è ‚úÖ üí°
- –ü–µ—Ä–µ–Ω–æ—Å—ã —Å—Ç—Ä–æ–∫
- –ü—Ä–æ—Å—Ç–æ–π —Ç–µ–∫—Å—Ç

‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω–æ:
- `**Markdown**` (–±—É–¥–µ—Ç –≤–∏–¥–Ω–æ –∫–∞–∫ `**—Ç–µ–∫—Å—Ç**`)
- HTML —Ç–µ–≥–∏

## üìû –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ—Ç–≤–µ—Ç–∞ –±–æ—Ç–∞

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`
2. –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–ª–∏ –≤–µ—Ä–Ω—É–≤—à–∏–π—Å—è
3. –ë–æ—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ–µ –Ω–µ–≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –æ—Ç–≤–µ—Ç (A, B, C, –∏–ª–∏ D)
5. –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç
6. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–º —è–∑—ã–∫–µ
7. –ë–æ—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∑–∞–¥–∞–Ω–∏—é

## üîÑ –¶–∏–∫–ª –∂–∏–∑–Ω–∏ –∑–∞–¥–∞–Ω–∏—è

```
getAllTasks() ‚Üí —Ñ–∏–ª—å—Ç—Ä –ø–æ completedTasks ‚Üí —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä ‚Üí –ø–æ–∫–∞–∑ ‚Üí –æ—Ç–≤–µ—Ç ‚Üí –∑–∞–ø–∏—Å—å –≤ answers ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ completedTasks
```
